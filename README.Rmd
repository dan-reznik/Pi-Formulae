---
title: "Computing π w/ Ramanujan-Sato"
output: github_document
---

```{r,echo=F}
knitr::opts_chunk$set(
  cache=T,
  collapse=T,
  comment="#>"
)
```

One of [Ramanujan-Sato](https://en.wikipedia.org/wiki/Ramanujan%E2%80%93Sato_series) Formulas for π (1917):

```{r,echo=F,out.width="50%",fig.align="center"}
knitr::include_graphics("pics/ramanujan-sato.png")
```

Consider the $396^(4k)$ term in the series. Suppose k=4. Computing this value in R yields a small number of significant digits:

```{r}
396^(4*4)
```

To properly represent the large terms in the series, we will use arbitrary-precision numbers and operations from the excellent [Rmpfr](https://cran.r-project.org/web/packages/Rmpfr/vignettes/Rmpfr-pkg.pdf) package. When represented with 120 bits, the term above becomes:

```{r}
Rmpfr::mpfr(396, 120)^(4*4)
```

***

Load the arbitrary-precision library

```{r,message=F}
library(Rmpfr) # use this for arbitrary-precision floats
```

We will be using 120 bits of representation precision:

```{r}
bits <- 120
```

One term of the R-S series and its front coefficient:

```{r}
sqrt2 <- sqrt(mpfr(2L, bits))
rs_coeff <- 9801L/(2L*sqrt2)

rs_term <- function(k) {
  num <- factorial(4L*k)*(26390L*k+1103L)
  den <- (factorial(k)*(396L^k))^4L
  num/den
}
```

Calculates π w/ kmax iterations of the R-S formula:

```{r}
rs_series <- function(kmax) {
  terms <- rs_term(mpfr(0:(kmax-1),bits))
  (rs_coeff/cumsum(terms))
}
```

Only 5 iterations and we're pretty close:

```{r}
rs_series(5)
```

Error from π computed internally by Rmpfr:

```{r}
rs_series(5)-Const("pi",bits)
```

Mind-blowing convergence of π digits through the Ramanujan-Sato series! `r emo::ji("smile")`

*** 

### References:

* N. Baruah, B. Berndt, H. Chan, "Ramanujan’s Series for 1/π: A Survey", Mathematical Association of America, Aug-Sept 2009. [pdf](https://faculty.math.illinois.edu/~berndt/articles/monthly567-587.pdf)
* Wikipedia, "[Srinivasa Ramanujan](https://en.wikipedia.org/wiki/Srinivasa_Ramanujan)"
* M. Mächler, "Arbitrarily Accurate Computation with R: The Rmpfr Package", ETH Zurich, 2019. [pdf](https://cran.r-project.org/web/packages/Rmpfr/vignettes/Rmpfr-pkg.pdf)

***

© 2019 Dan S. Reznik
